<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Doctor Workflow | NAMASTE-FHIR Terminology</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/ui/assets/css/main.css">
</head>
<body>
    <header>
        <div class="container">
            <nav class="navbar">
                <div class="logo">NAMASTE-FHIR</div>
                <ul class="nav-menu">
                    <li><a href="/ui/pages/index.html">Home</a></li>
                    <li><a href="/ui/pages/doctor-workflow.html">Doctor Workflow</a></li>
                    <li><a href="/ui/pages/researcher-workflow.html">Researcher</a></li>
                    <li><a href="/ui/pages/insurance-workflow.html">Insurance</a></li>
                    <li><a href="/ui/pages/api-docs.html">API Docs</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main class="container">
        <section class="doctor-workflow">
            <div class="card">
                <h1>Doctor Workflow</h1>
                <p>Diagnose patients using AYUSH terminologies with automatic mapping to international codes.</p>
            </div>
            
            <div class="card">
                <h2>Patient Information</h2>
                <div class="form-group">
                    <label for="patient-id">ABHA ID (For Demo)</label>
                    <input type="text" id="patient-id" value="1234-5678-9012" readonly>
                </div>
                <div class="form-group">
                    <label for="patient-name">Patient Name</label>
                    <input type="text" id="patient-name" value="Sample Patient" readonly>
                </div>
            </div>
            
            <div class="card">
                <h2>Diagnosis</h2>
                <div class="form-group">
                    <label for="diagnosis-search">Search for AYUSH Diagnosis</label>
                    <div class="autocomplete-container">
                        <input type="text" id="diagnosis-search" placeholder="Type to search (e.g., Amlapitta, Vata...)">
                        <div id="search-results" class="autocomplete-results"></div>
                    </div>
                    <small>Type at least 2 characters to search in NAMASTE terminology</small>
                </div>
            </div>
            
            <div class="card">
                <h2>Problem List</h2>
                <div id="problem-list" class="problem-list">
                    <div class="empty-list-message">No problems added yet</div>
                </div>
                <button id="export-fhir" class="btn">Export as FHIR Bundle</button>
            </div>
            
            <div class="card">
                <h2>Sample Data</h2>
                <p>For demonstration purposes, you can try searching for these AYUSH terms:</p>
                <ul>
                    <li>Amlapitta (Acid reflux)</li>
                    <li>Vata-Kaphaja Jwara (Fever with Vata-Kapha imbalance)</li>
                    <li>Raktapitta (Bleeding disorder)</li>
                    <li>Sannipata Jwara (Fever with tridosha imbalance)</li>
                    <li>Rajayakshma (Tuberculosis)</li>
                </ul>
            </div>
        </section>
    </main>

    <footer>
        <div class="container">
            <p>&copy; 2025 Ministry of Ayush | All India Institute of Ayurveda (AIIA)</p>
        </div>
    </footer>

    <script src="/ui/assets/js/main.js"></script>
    <script>
        // Simulated autocomplete results for demo
        const mockResults = [
            { term: "Amlapitta", namasteCode: "A.9.1.1", icdCode: "TM1.A50" },
            { term: "Vata-Kaphaja Jwara", namasteCode: "A.5.1.3", icdCode: "TM1.F10.2" },
            { term: "Raktapitta", namasteCode: "A.10.2", icdCode: "TM1.B22" },
            { term: "Sannipata Jwara", namasteCode: "A.5.1.7", icdCode: "TM1.F10.7" },
            { term: "Rajayakshma", namasteCode: "A.17.1", icdCode: "TM1.M50" }
        ];
        
        // Override fetch for demo purposes
        const originalFetch = window.fetch;
        window.fetch = function(url, options) {
            // Mock the autocomplete endpoint
            if (url.includes('/api/autocomplete')) {
                return new Promise((resolve) => {
                    setTimeout(() => {
                        const searchParam = new URLSearchParams(url.split('?')[1]).get('term');
                        const results = mockResults.filter(r => 
                            r.term.toLowerCase().includes(searchParam.toLowerCase())
                        );
                        
                        resolve({
                            ok: true,
                            json: () => Promise.resolve({ results })
                        });
                    }, 300);
                });
            }
            
            // Pass through to original fetch for all other URLs
            return originalFetch(url, options);
        };
    </script>
</body>
</html>
