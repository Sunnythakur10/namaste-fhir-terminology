<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Researcher Workflow | NAMASTE-FHIR Terminology</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/ui/assets/css/main.css">
</head>
<body>
    <header>
        <div class="container">
            <nav class="navbar">
                <div class="logo">NAMASTE-FHIR</div>
                <ul class="nav-menu">
                    <li><a href="/ui/pages/landing.html">Home</a></li>
                    <li><a href="/ui/pages/doctor-workflow.html">Doctor Workflow</a></li>
                    <li><a href="/ui/pages/researcher-workflow.html">Researcher</a></li>
                    <li><a href="/ui/pages/insurance-workflow.html">Insurance</a></li>
                    <li><a href="/ui/pages/api-docs.html">API Docs</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main class="container">
        <section class="researcher-workflow">
            <div class="card">
                <h1>Researcher Workflow</h1>
                <p>Query prevalence of codes and analyze morbidity data for research purposes.</p>
            </div>
            
            <div class="card">
                <h2>Morbidity Data Analysis</h2>
                <div class="form-group">
                    <label for="time-period">Time Period</label>
                    <select id="time-period">
                        <option value="day">Last 24 Hours</option>
                        <option value="week">Last Week</option>
                        <option value="month" selected>Last Month</option>
                        <option value="year">Last Year</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="display-format">Display Format</label>
                    <select id="display-format">
                        <option value="chart">Chart View</option>
                        <option value="table">Table View</option>
                    </select>
                </div>
                <button id="run-analysis" class="btn">Run Analysis</button>
            </div>
            
            <div class="card">
                <h2>Results</h2>
                <div id="analysis-results">
                    <p class="placeholder-text">Run analysis to see results</p>
                    <canvas id="resultsChart" width="600" height="400" style="display: none;"></canvas>
                    <div id="resultsTable" style="display: none;"></div>
                </div>
                <div class="export-options" style="display: none;">
                    <button id="export-csv" class="btn btn-secondary">Export as CSV</button>
                    <button id="export-fhir-json" class="btn btn-secondary">Export as FHIR JSON</button>
                </div>
            </div>
            
            <div class="card">
                <h2>Coming Soon</h2>
                <p>Additional research features in development:</p>
                <ul>
                    <li>Geographical distribution of cases</li>
                    <li>Demographic analysis</li>
                    <li>Temporal trends</li>
                    <li>Co-occurrence patterns</li>
                    <li>Treatment effectiveness comparison</li>
                </ul>
            </div>
        </section>
    </main>

    <footer>
        <div class="container">
            <p>&copy; 2025 Ministry of Ayush | All India Institute of Ayurveda (AIIA)</p>
        </div>
    </footer>

    <script src="/ui/assets/js/main.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.4/dist/chart.umd.min.js"></script>
    <script>
        // Placeholder for researcher workflow demo
        document.addEventListener('DOMContentLoaded', () => {
            const runAnalysisBtn = document.getElementById('run-analysis');
            const timePeriod = document.getElementById('time-period');
            const displayFormat = document.getElementById('display-format');
            const resultsChart = document.getElementById('resultsChart');
            const resultsTable = document.getElementById('resultsTable');
            const placeholderText = document.querySelector('.placeholder-text');
            const exportOptions = document.querySelector('.export-options');
            
            runAnalysisBtn.addEventListener('click', () => {
                placeholderText.style.display = 'none';
                exportOptions.style.display = 'block';
                
                if (displayFormat.value === 'chart') {
                    resultsChart.style.display = 'block';
                    resultsTable.style.display = 'none';
                    
                    // Sample chart data
                    const ctx = resultsChart.getContext('2d');
                    new Chart(ctx, {
                        type: 'bar',
                        data: {
                            labels: ['Amlapitta', 'Vata-Kaphaja Jwara', 'Raktapitta', 'Sannipata Jwara', 'Rajayakshma'],
                            datasets: [{
                                label: 'Cases in ' + timePeriod.options[timePeriod.selectedIndex].text,
                                data: [42, 28, 15, 22, 8],
                                backgroundColor: [
                                    '#4CAF50', '#FFC107', '#2196F3', '#FF5722', '#9C27B0'
                                ]
                            }]
                        },
                        options: {
                            responsive: true,
                            plugins: {
                                title: {
                                    display: true,
                                    text: 'Disease Distribution for ' + timePeriod.options[timePeriod.selectedIndex].text
                                }
                            }
                        }
                    });
                } else {
                    resultsChart.style.display = 'none';
                    resultsTable.style.display = 'block';
                    
                    // Sample table data
                    resultsTable.innerHTML = `
                        <table class="parameter-table">
                            <thead>
                                <tr>
                                    <th>Disease</th>
                                    <th>NAMASTE Code</th>
                                    <th>ICD-11 Code</th>
                                    <th>Cases</th>
                                    <th>Percentage</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Amlapitta</td>
                                    <td>A.9.1.1</td>
                                    <td>TM1.A50</td>
                                    <td>42</td>
                                    <td>36.5%</td>
                                </tr>
                                <tr>
                                    <td>Vata-Kaphaja Jwara</td>
                                    <td>A.5.1.3</td>
                                    <td>TM1.F10.2</td>
                                    <td>28</td>
                                    <td>24.3%</td>
                                </tr>
                                <tr>
                                    <td>Raktapitta</td>
                                    <td>A.10.2</td>
                                    <td>TM1.B22</td>
                                    <td>15</td>
                                    <td>13.0%</td>
                                </tr>
                                <tr>
                                    <td>Sannipata Jwara</td>
                                    <td>A.5.1.7</td>
                                    <td>TM1.F10.7</td>
                                    <td>22</td>
                                    <td>19.1%</td>
                                </tr>
                                <tr>
                                    <td>Rajayakshma</td>
                                    <td>A.17.1</td>
                                    <td>TM1.M50</td>
                                    <td>8</td>
                                    <td>7.0%</td>
                                </tr>
                            </tbody>
                        </table>
                    `;
                }
            });
        });
    </script>
</body>
</html>
